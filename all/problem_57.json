{
    "problem": "Show that a rational function \\( R(x) \\) satisfies\n\\[\n\\int_{-\\infty}^\\infty f(R(x)) \\, dx = \\int_{-\\infty}^\\infty f(x) \\, dx\n\\]\nfor all piecewise continuous functions \\( f(x) \\) such that \\( \\int_{-\\infty}^\\infty f(x) \\, dx \\) exists, if and only if\n\\[\nR(x) = \\pm \\left( x - \\alpha_0 - \\sum_{k=1}^m \\frac{c_k}{x - \\alpha_k} \\right)\n\\]\nfor some non-negative integer \\( m \\), real constants \\( \\alpha_0, \\alpha_1, \\ldots, \\alpha_m \\) with \\( \\alpha_1 < \\cdots < \\alpha_m \\), and positive constants \\( c_1, \\ldots, c_m \\).",
    "problem_type": "Improper Integrals",
    "solution": "The proof is based on Szegő (1934).\n\nFor any \\( \\epsilon \\) in the interval \\( (0, 1) \\), we can find a positive constant \\( M \\) satisfying\n\\[\n|R(x) - R(x_0)| \\leq |R'(x_0)| \\epsilon + M \\epsilon^2\n\\]\nfor any \\( |x - x_0| \\leq \\epsilon \\) unless \\( x_0 \\) is a real pole of \\( R(x) \\). Let \\( f_\\epsilon(x) \\) be the piecewise continuous function defined by\n\\[\nf_\\epsilon(x) =\n\\begin{cases} \n1 & \\text{if } |x - R(x_0)| \\leq |R'(x_0)| \\epsilon + M \\epsilon^2, \\\\\n0 & \\text{otherwise}.\n\\end{cases}\n\\]\n\nThen we have\n\\[\n2 \\epsilon (|R'(x_0)| + M \\epsilon) = \\int_{-\\infty}^\\infty f_\\epsilon(x) \\, dx \\geq \\int_{x_0-\\epsilon}^{x_0+\\epsilon} f_\\epsilon(R(x)) \\, dx = 2 \\epsilon;\n\\]\nhence, \\( \\epsilon \\) being arbitrary, we have \\( |R'(x_0)| \\geq 1 \\). This means that \\( R(x) \\) maps each interval divided by real poles of \\( R(x) \\), say \\( \\alpha_1 < \\alpha_2 < \\cdots < \\alpha_m \\), bijectively on \\( \\mathbb{R} \\). Of course \\( m = 0 \\) corresponds to the case in which \\( R(x) \\) has no real poles. The equation \\( R(x) = s \\) has a unique solution in each interval \\( (-\\infty, \\alpha_1), (\\alpha_1, \\alpha_2), \\ldots, (\\alpha_m, \\infty) \\), say \\( x_k(s) \\), \\( 0 \\leq k \\leq m \\).\n\nNext, let \\( g_\\epsilon(x) \\) be the piecewise continuous function defined by\n\\[\ng_\\epsilon(x) =\n\\begin{cases} \n1 & \\text{if } |x - s| \\leq \\epsilon, \\\\\n0 & \\text{otherwise}.\n\\end{cases}\n\\]\n\nWe then have\n\\[\n2 \\epsilon = \\int_{-\\infty}^\\infty g_\\epsilon(x) \\, dx = \\int_{-\\infty}^\\infty g_\\epsilon(R(x)) \\, dx, \\tag{6.6}\n\\]\nwhere the right-hand side is equal to the sum of lengths of \\( m+1 \\) intervals satisfying \\( |R(x) - s| \\leq \\epsilon \\). Each of these intervals contains exactly one \\( x_k(s) \\), and the length is\n\\[\n\\frac{2 \\epsilon}{|R'(x_k(s))|} + O(\\epsilon^2);\n\\]\nso letting \\( \\epsilon \\to 0^+ \\) in (6.6), we get\n\\[\n\\sum_{k=0}^m \\frac{1}{|R'(x_k(s))|} = 1. \\tag{6.7}\n\\]\nIn the case $m = 0$ the function $R(x)$ maps $\\mathbb{R}$ homeomorphically onto $\\mathbb{R}$ and $R'(x_0(s)) = \\pm 1$ implies that\n\\[\nx_0'(s) = (R^{-1})'(s) = \\frac{1}{R'(R^{-1}(s))} = \\frac{1}{R'(x_0(s))} = \\pm 1.\n\\]\nTherefore $R(x) = \\pm (x - a_0)$ for some constant $a_0$ for $m = 0$.\n\nWe hereafter assume that $m$ is a positive integer. Since $|R'(x_k(s))|$ diverges to $\\infty$ as $|s| \\to \\infty$ for each $1 \\leq k \\leq m$, it follows from $(6.7)$ that either\n\\[\n\\begin{cases}\nR'(x) \\geq 1 \\text{ on } (-\\infty, \\alpha_1) \\cup (\\alpha_m, \\infty), \\\\\n\\lim_{s \\to -\\infty} x_0(s) = -\\infty, \\quad \\lim_{s \\to -\\infty} x_m(s) = \\alpha_m, \\\\\n\\lim_{s \\to \\infty} x_0(s) = \\alpha_1, \\quad \\lim_{s \\to \\infty} x_m(s) = \\infty,\n\\end{cases}\n\\]\nor\n\\[\n\\begin{cases}\nR'(x) \\leq -1 \\text{ on } (-\\infty, \\alpha_1) \\cup (\\alpha_m, \\infty), \\\\\n\\lim_{s \\to -\\infty} x_0(s) = \\alpha_1, \\quad \\lim_{s \\to -\\infty} x_m(s) = \\infty, \\\\\n\\lim_{s \\to \\infty} x_0(s) = -\\infty, \\quad \\lim_{s \\to \\infty} x_m(s) = \\alpha_m,\n\\end{cases}\n\\]\nholds. They are called the first and the second cases respectively.\n\nThe rational function $R(x)$ can now be represented as\n\\[\nR(x) = P(x) - \\sum_{k,\\ell} \\frac{c_{k,\\ell}}{(x - \\alpha_k)^{d_{k,\\ell}}} + Q(x),\n\\]\nwhere $P(x)$ is a polynomial of degree $r$ with some positive integer $r$, $c_{k,\\ell}$ are non-zero real constants, $d_{k,\\ell}$ are positive integers, and $Q(x)$ is a rational function having no real poles and converging to $0$ as $|x| \\to \\infty$ unless $Q(x)$ vanishes identically. Let $\\beta x^r$ be the leading term of $P(x)$ where $\\beta$ is a non-zero constant. Since $R'(x) \\sim \\beta r x^{r-1}$ as $|x| \\to \\infty$, we must have $r = 1$ and hence $\\beta = \\pm 1$ by $(6.7)$. Hence $P(x) = \\pm (x - a_0)$ for some constant $a_0$.\n\nWe first treat the first case. Since $R'(x) = 1 + O(x^{-2})$ as $|x| \\to \\infty$ in this case, we have\n\\[\n\\sum_{k=0}^{m-1} \\frac{1}{|R'(x_k(s))|} = O(s^{-2}) \\quad \\text{as } s \\to \\infty,\n\\]\n\\[\n\\sum_{k=1}^m \\frac{1}{|R'(x_k(s))|} = O(s^{-2}) \\quad \\text{as } s \\to -\\infty. \\tag{6.8}\n\\]\n\nLet $d_k^*$ be the largest integer among $d_{k,\\ell}$ and $c_k^*$ be the corresponding coefficient $c_{k,\\ell}$ for each $0 \\leq k \\leq m$. Clearly $x_k(s) \\to \\alpha_k$ either as $s \\to \\infty$ or $s \\to -\\infty$ for $1 \\leq k \\leq m$. Then we have\n\\[\nR(x) \\sim -\\frac{c_k^*}{(x - \\alpha_k)^{d_k^*}} \\quad \\text{as } x \\to \\alpha_k,\n\\]\nand in particular,\n\\[\ns = R(x_k(s)) \\sim -\\frac{c_k^*}{(x_k(s) - \\alpha_k)^{d_k^*}},\n\\]\nwhence solving in $x_k(s) - \\alpha_k$ and substituting in\n\\[\nR'(x_k(s)) \\sim \\frac{c_k^* d_k^*}{(x_k(s) - \\alpha_k)^{d_k^*+1}} \\quad \\text{as } x \\to \\alpha_k,\n\\]\nwe obtain\n\\[\n\\frac{1}{|R'(x_k(s))|} \\sim \\frac{|c_k^*|^{1/d_k^*}}{d_k^*} \\cdot \\frac{1}{|s|^{1+1/d_k^*}}\n\\]\neither as $s \\to \\infty$ or $s \\to -\\infty$. Therefore, in view of $(6.8)$, $d_k^* = 1$ and $R(x)$ can be written as\n\\[\nR(x) = x - a_0 - \\sum_{k=1}^m \\frac{c_k}{x - \\alpha_k} + Q(x) \\tag{6.9}\n\\]\nfor some real constants $c_k$ in the first case. Since $R(x)$ is monotone increasing on $(\\alpha_m, \\infty)$ we have $c_m > 0$ and hence all coefficients $c_k$ must be positive; in particular,\n\\[\n\\sum_{k=0}^m \\frac{1}{R'(x_k(s))} = 1. \\tag{6.10}\n\\]\n\nDifferentiating $s = R(x_k(s))$ in $s$ and substituting in $(6.10)$, we get\n\\[\n\\sum_{k=0}^m x_k'(s) = 1,\n\\]\nfrom which it follows that\n\\[\n\\sum_{k=0}^m x_k(s) = s + c'. \n\\]\nfor some constant $c'$. Since $x_m(s) = s + a_0 + O(s^{-1})$ and $x_k(s) = \\alpha_k + O(s^{-1})$ as $s \\to \\infty$ for each $0 \\leq k < m$, we have\n\\[\n\\sum_{k=0}^m x_k(s) = s + \\sum_{k=0}^m \\alpha_k. \\tag{6.11}\n\\]\n\nThe rest of the proof is devoted to showing the vanishing of $Q$. It may be interesting to find an easier real-analytic proof of this part.\n\nSuppose, on the contrary, that $Q(x) \\not\\equiv 0$. Then, in view of $(6.9)$, we can write\n\\[\nR(x) = \\frac{V(x)}{U(x)} \\quad \\text{with} \\quad U(x) = A(x) \\prod_{k=1}^m (x - \\alpha_k)\n\\]\nwhere\n\\[\n\\begin{aligned}\nA(x) &= x^{2p} - c''x^{2p-1} + O(x^{2p-2}), \\\\\nV(x) &= x^{m+2p+1} - \\left(c'' + \\sum_{k=0}^m \\alpha_k \\right)x^{m+2p} + O(x^{m+2p-1})\n\\end{aligned}\n\\]\nare polynomials with real coefficients for some positive integer $p$ and some constant $c''$. We can assume that $U(x)$ and $V(x)$ are relatively prime; that is, they have no common factor except for constants. Let $w_1, w_1', \\ldots, w_p, w_p'$ be non-real zeros of $A(z)$. The algebraic equation\n\\[\nV(z) = sU(z)\n\\]\nhas exactly $m + 1$ real simple roots $x_0(s), \\ldots, x_m(s)$ and $2p$ non-real roots $z_1(s), \\ldots, z_p(s), z_1'(s), \\ldots, z_p'(s)$ counting with multiplicity for any real number $s$. Then we have from $(6.11)$\n\\[\n\\frac{z_1(s) + z_1'(s) + \\cdots + z_p(s) + z_p'(s)}{s} = c''.\n\\]\n\nLet $C$ be a circle enclosing all the zeros of $U(z)$. Take a sufficiently large $s$ such that\n\\[\ns \\min_{z \\in C} |U(z)| > \\max_{z \\in C} |V(z)|\n\\]\nand that $x_m(s)$ lies outside of $C$. Since $|V(z)| < s|U(z)|$ on $C$, it follows from Rouché's theorem that $V(z) = sU(z)$ has exactly $m + 2p$ roots inside of $C$, which are of course $x_1(s), \\ldots, x_m(s)$ and $z_1(s), \\ldots, z_p(s), z_1'(s), \\ldots, z_p'(s)$. This implies that all the non-real roots are bounded as $s \\to \\infty$.\n\\[\nV(z) - sU(z) \\text{ is irreducible as a polynomial of two variables; that is, it cannot be expressed as the product of two polynomials none of which is constant.}\n\\]\nWe then consider \\( x_k(s) \\) and \\( z_k(s) \\) as function elements of the algebraic function uniquely determined by \\( V(z) - sU(z) = 0 \\). Since all solutions of \\( V(z) - sU(z) = 0 \\) are branches of the same algebraic function, it follows in particular that \\( x_m(s) \\) can be continued to \\( z_1(s) \\) along an arc on the Riemann surface of this algebraic function. This is a contradiction, since the relation \\( (6.12) \\) holds globally except for possible isolated singularities and since \\( x_m(s) \\) is a unique solution which is unbounded as \\( s \\to \\infty \\). Therefore \\( p = 0 \\) and hence \\( Q(x) \\) must vanish identically, completing the proof of the first part.\n\n\\textbf{The similar argument can be applied to the second case.}\n\nConversely, let\n\\[\nR(x) = \\pm \\left( x - a_0 - \\sum_{k=1}^m \\frac{c_k}{x - \\alpha_k} \\right)\n\\]\nfor some real numbers \\( a_0, \\ldots, \\alpha_m \\) with \\( \\alpha_1 < \\cdots < \\alpha_m \\) and some positive constants \\( c_1, \\ldots, c_m \\). Then it is clear that \\( \\sum_{k=0}^m x_k'(s) = \\pm 1 \\) and hence\n\\[\n\\int_{-\\infty}^\\infty f(R(x)) dx = \\int_{-\\infty}^{\\alpha_1} + \\cdots + \\int_{\\alpha_m}^\\infty f(R(x)) dx\n\\]\n\\[\n= \\pm \\sum_{k=0}^m \\int_{-\\infty}^\\infty f(s) x_k'(s) ds,\n\\]\nwhich is equal to\n\\[\n\\int_{-\\infty}^\\infty f(x) dx. \\quad \\Box\n\\]\n"
}